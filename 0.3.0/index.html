<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge" ></meta>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" />
<!--[if lte IE 10]>
  <script src="doc/vendor/polyfill/main.js" ></script>
 <![endif]-->
<script src="doc/vendor/react/0.14.8/react.js" ></script>
<script src="doc/vendor/react/0.14.8/react-dom.js" ></script>
<script src="doc/vendor/moment/2.15.1/moment.js" ></script>
<style>
/* http://cdn.bootcss.com/highlight.js/9.6.0/styles/atom-one-dark.min.css */
pre { background: rgb(33,37,46); border-radius: 5px; padding: .5em 1em; color:rgb(155,162,178);}
.hljs{display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-keyword,.hljs-formula{color:#c678dd}.hljs-section,.hljs-name,.hljs-selector-tag,.hljs-deletion,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-string,.hljs-regexp,.hljs-addition,.hljs-attribute,.hljs-meta-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-variable,.hljs-template-variable,.hljs-type,.hljs-selector-class,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-number{color:#d19a66}.hljs-symbol,.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:bold}.hljs-link{text-decoration:underline}

.markdown-body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; font-size: 16px; line-height: 1.5; word-wrap: break-word;padding-left:10px;padding-right: 10px;} .markdown-body::before { display: table; content: "" } .markdown-body::after { display: table; clear: both; content: "" } .markdown-body>*:first-child { margin-top: 0 !important } .markdown-body>*:last-child { margin-bottom: 0 !important } .markdown-body a:not([href]) { color: inherit; text-decoration: none } .markdown-body .absent { color: #c00 } .markdown-body .anchor { float: left; padding-right: 4px; margin-left: -20px; line-height: 1 } .markdown-body .anchor:focus { outline: none } .markdown-body p,.markdown-body blockquote,.markdown-body ul,.markdown-body ol,.markdown-body dl,.markdown-body table,.markdown-body pre { margin-top: 16px; margin-bottom: 16px } .markdown-body hr { height: 0.25em; padding: 0; margin: 24px 0; background-color: #e7e7e7; border: 0 } .markdown-body blockquote { padding: 0 1em; color: #777; border-left: 0.25em solid #ddd } .markdown-body blockquote>:first-child { margin-top: 0 } .markdown-body blockquote>:last-child { margin-bottom: 0 } .markdown-body kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: #555; vertical-align: middle; background-color: #fcfcfc; border: solid 1px #ccc; border-bottom-color: #bbb; border-radius: 3px; box-shadow: inset 0 -1px 0 #bbb } .markdown-body .loweralpha { list-style-type: lower-alpha } .markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6 { margin-top: 24px; margin-bottom: 16px; font-weight: 600; line-height: 1.25 } .markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link { color: #000; vertical-align: middle; visibility: hidden } .markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor { text-decoration: none } .markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link { visibility: visible } .markdown-body h1 tt,.markdown-body h1 code,.markdown-body h2 tt,.markdown-body h2 code,.markdown-body h3 tt,.markdown-body h3 code,.markdown-body h4 tt,.markdown-body h4 code,.markdown-body h5 tt,.markdown-body h5 code,.markdown-body h6 tt,.markdown-body h6 code { font-size: inherit } .markdown-body h1 { padding-bottom: 0.3em; font-size: 2em; border-bottom: 1px solid #eee } .markdown-body h2 { padding-bottom: 0.3em; font-size: 1.5em; border-bottom: 1px solid #eee } .markdown-body h3 { font-size: 1.25em } .markdown-body h4 { font-size: 1em } .markdown-body h5 { font-size: 0.875em } .markdown-body h6 { font-size: 0.85em; color: #777 } .markdown-body ul,.markdown-body ol { padding-left: 2em } .markdown-body ul.no-list,.markdown-body ol.no-list { padding: 0; list-style-type: none } .markdown-body ul ul,.markdown-body ul ol,.markdown-body ol ol,.markdown-body ol ul { margin-top: 0; margin-bottom: 0 } .markdown-body li>p { margin-top: 16px } .markdown-body li+li { margin-top: 0.25em } .markdown-body dl { padding: 0 } .markdown-body dl dt { padding: 0; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold } .markdown-body dl dd { padding: 0 16px; margin-bottom: 16px } .markdown-body table { display: block; width: 100%; overflow: auto } .markdown-body table th { font-weight: bold } .markdown-body table th,.markdown-body table td { padding: 6px 13px; border: 1px solid #ddd } .markdown-body table tr { background-color: #fff; border-top: 1px solid #ccc } .markdown-body table tr:nth-child(2n) { background-color: #f8f8f8 } .markdown-body img { max-width: 100%; box-sizing: content-box; background-color: #fff } .markdown-body img[align=right] { padding-left: 20px } .markdown-body img[align=left] { padding-right: 20px } .markdown-body .emoji { max-width: none; vertical-align: text-top; background-color: transparent } .markdown-body span.frame { display: block; overflow: hidden } .markdown-body span.frame>span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0 0; overflow: hidden; border: 1px solid #ddd } .markdown-body span.frame span img { display: block; float: left } .markdown-body span.frame span span { display: block; padding: 5px 0 0; clear: both; color: #333 } .markdown-body span.align-center { display: block; overflow: hidden; clear: both } .markdown-body span.align-center>span { display: block; margin: 13px auto 0; overflow: hidden; text-align: center } .markdown-body span.align-center span img { margin: 0 auto; text-align: center } .markdown-body span.align-right { display: block; overflow: hidden; clear: both } .markdown-body span.align-right>span { display: block; margin: 13px 0 0; overflow: hidden; text-align: right } .markdown-body span.align-right span img { margin: 0; text-align: right } .markdown-body span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden } .markdown-body span.float-left span { margin: 13px 0 0 } .markdown-body span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden } .markdown-body span.float-right>span { display: block; margin: 13px auto 0; overflow: hidden; text-align: right } .markdown-body code,.markdown-body tt { padding: 0; padding-top: 0.2em; padding-bottom: 0.2em; margin: 0; font-size: 85%; background-color: rgba(0,0,0,0.04); border-radius: 3px } .markdown-body code::before,.markdown-body code::after,.markdown-body tt::before,.markdown-body tt::after { letter-spacing: -0.2em; content: "\00a0" } .markdown-body code br,.markdown-body tt br { display: none } .markdown-body del code { text-decoration: inherit } .markdown-body pre { word-wrap: normal } .markdown-body pre>code { padding: 0; margin: 0; font-size: 100%; word-break: normal; white-space: pre; background: transparent; border: 0 } .markdown-body .highlight { margin-bottom: 16px } .markdown-body .highlight pre { margin-bottom: 0; word-break: normal } .markdown-body .highlight pre,.markdown-body pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45;  border-radius: 3px } .markdown-body pre code,.markdown-body pre tt { display: inline; max-width: auto; padding: 0; margin: 0; overflow: visible; line-height: inherit; word-wrap: normal; background-color: transparent; border: 0 } .markdown-body pre code::before,.markdown-body pre code::after,.markdown-body pre tt::before,.markdown-body pre tt::after { content: normal }
html body {
    width:1100px;
    margin-left: auto;
    margin-right: auto;
}
</style>
<title> timer</title>
</head>
<body class="markdown-body" >
<h1 id="timer">timer</h1>
<script src="http://cdn.bootcss.com/react/0.14.8/react.js" ></script>
<script src="http://cdn.bootcss.com/react/0.14.8/react-dom.min.js" ></script>
<script src="http://cdn.bootcss.com/moment.js/2.14.1/moment.min.js"></script>

<blockquote>
<p>可复用定时器，可用于限制邮件短信发送</p>
<p>Online demo: <a href="https://fast-flow.github.io/timer/">https://fast-flow.github.io/timer/</a></p>
</blockquote>
<h2 id="features">Features</h2>
<ul>
<li>React</li>
<li>DOM function</li>
<li>Cache second (localStorage or cookie)</li>
<li>DIY</li>
</ul>
<pre><code>npm <span class="hljs-keyword">install</span> <span class="hljs-keyword">fast</span>-timer <span class="hljs-comment">--save</span>
</code></pre><div class="markrun markrun--css" >
	<div class="markrun-code" >
		<style type="text/css" >
.m-btn {
    background-color: #999;border:none;
}
html .m-btn--timing {
    background-color: #eee;
}
</style>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-selector-class">.m-btn</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#999</span>;<span class="hljs-attribute">border</span>:none;
}
<span class="hljs-selector-tag">html</span> <span class="hljs-selector-class">.m-btn--timing</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#eee</span>;
}
</code></pre>
	</div>
</div>
<h2 id="fast-timer-react">fast-timer/react</h2>
<div id="reactNode"></div>

<div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var ReactDOM = __webpack_require__(1);
		var TimerBtn = __webpack_require__(2);
		var reactSendAjax = false;
		var props = {
			sec: 5,
			// cache: refresh page auto start | 缓存： 刷新页面自动开始计时
			cache: 'somer983ghiu3h',
			className: 'm-btn',
			timingClass: 'm-btn--timing',
			trigger: function trigger(start) {
				console.log('react trigger');
				if (reactSendAjax) {
					return;
				} else {
					console.log('react start');
					reactSendAjax = true;
					// mock send ajax timeout
					setTimeout(function () {
						start();
						reactSendAjax = false;
					}, 1000);
				}
			},
			html: 'React Send',
			watch: function watch(date) {
				if (date.sec) {
					return date.sec + 's';
				} else {
					return 'Resend';
				}
			}
		};
		ReactDOM.render(React.createElement(TimerBtn, props), document.getElementById('reactNode'));

		/***/
	},
	/* 1 */
	/***/function (module, exports) {

		module.exports = ReactDOM;

		/***/
	},
	/* 2 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		Object.defineProperty(exports, "__esModule", {
			value: true
		});

		var _createClass = function () {
			function defineProperties(target, props) {
				for (var i = 0; i < props.length; i++) {
					var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
				}
			}return function (Constructor, protoProps, staticProps) {
				if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
			};
		}();

		var _fastTimer = __webpack_require__(3);

		var _fastTimer2 = _interopRequireDefault(_fastTimer);

		var _react = __webpack_require__(7);

		var _classnames = __webpack_require__(8);

		var _classnames2 = _interopRequireDefault(_classnames);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		function _defineProperty(obj, key, value) {
			if (key in obj) {
				Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });
			} else {
				obj[key] = value;
			}return obj;
		}

		function _classCallCheck(instance, Constructor) {
			if (!(instance instanceof Constructor)) {
				throw new TypeError("Cannot call a class as a function");
			}
		}

		function _possibleConstructorReturn(self, call) {
			if (!self) {
				throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
			}return call && ((typeof call === 'undefined' ? 'undefined' : _typeof(call)) === "object" || typeof call === "function") ? call : self;
		}

		function _inherits(subClass, superClass) {
			if (typeof superClass !== "function" && superClass !== null) {
				throw new TypeError("Super expression must either be null or a function, not " + (typeof superClass === 'undefined' ? 'undefined' : _typeof(superClass)));
			}subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
		}

		var TimerBtn = function (_Component) {
			_inherits(TimerBtn, _Component);

			function TimerBtn(props) {
				_classCallCheck(this, TimerBtn);

				var _this = _possibleConstructorReturn(this, (TimerBtn.__proto__ || Object.getPrototypeOf(TimerBtn)).call(this, props));

				var self = _this;
				self.state = {
					sec: 0,
					html: props.html
				};
				return _this;
			}

			_createClass(TimerBtn, [{
				key: "componentWillMount",
				value: function componentWillMount() {
					var self = this;
					self.fastTimer = new _fastTimer2["default"]({
						cache: self.props.cache
					});
					self.fastTimer.watch(function (date) {
						self.setState({
							sec: date.sec
						});
					});
					if (self.fastTimer.cacheSec()) {
						self.fastTimer.start(self.fastTimer.cacheSec());
					}
				}
			}, {
				key: "handleClick",
				value: function handleClick() {
					var self = this;
					if (self.fastTimer.free) {
						self.props.trigger(function () {
							self.fastTimer.start(self.props.sec);
						});
					}
				}
			}, {
				key: "render",
				value: function render() {
					var _cls;

					var html = void 0;
					if (this.fastTimer.free) {
						html = this.state.html;
					} else {
						html = this.props.watch({
							sec: this.state.sec
						});
					}
					return React.createElement("span", { className: (0, _classnames2["default"])((_cls = {}, _defineProperty(_cls, this.props.className, true), _defineProperty(_cls, this.props.timingClass, !this.fastTimer.free), _cls)),
						dangerouslySetInnerHTML: { __html: html },
						onClick: this.handleClick.bind(this)
					});
				}
			}]);

			return TimerBtn;
		}(_react.Component);

		exports["default"] = TimerBtn;

		module.exports = TimerBtn;

		/***/
	},
	/* 3 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		Object.defineProperty(exports, "__esModule", {
			value: true
		});
		exports["default"] = __webpack_require__(4);

		module.exports = __webpack_require__(4);

		/***/
	},
	/* 4 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		var _createClass = function () {
			function defineProperties(target, props) {
				for (var i = 0; i < props.length; i++) {
					var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
				}
			}return function (Constructor, protoProps, staticProps) {
				if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
			};
		}();

		var _moment = __webpack_require__(5);

		var _moment2 = _interopRequireDefault(_moment);

		var _simpleBrowserStorage = __webpack_require__(6);

		var _simpleBrowserStorage2 = _interopRequireDefault(_simpleBrowserStorage);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		function _classCallCheck(instance, Constructor) {
			if (!(instance instanceof Constructor)) {
				throw new TypeError("Cannot call a class as a function");
			}
		}

		var Timer = function () {
			function Timer(settings) {
				_classCallCheck(this, Timer);

				settings = settings || {};
				this.free = true;
				this._watchQueue = [];
				this._settings = settings;
				this._storage = (0, _simpleBrowserStorage2["default"])({
					name: settings.cache,
					expiresTime: 43200
				});
			}

			_createClass(Timer, [{
				key: "_countDown",
				value: function _countDown() {
					var self = this;
					// @1 @2 必须按先后顺序执行，因为 watch 需要获取 free
					// @1 Start
					if (self._countDownSec === 0) {
						this.free = true;
					} else {
						setTimeout(self._countDown.bind(self), 1000);
					}
					// @1 End
					// @2 Start
					self._watchQueue.forEach(function (fn) {
						fn.call(self, {
							sec: self._countDownSec
						});
					});
					// 递减需要在 watch 后执行。例如 sec 为 10 秒，最初应该 watch 触发 10 ，而不是 9。
					self._countDownSec = self._countDownSec - 1;
					// @2 End
				}
			}, {
				key: "_setEndDateInCache",
				value: function _setEndDateInCache(sec) {
					var self = this;
					self._storage.setState({
						endDate: (0, _moment2["default"])().add(sec, 's')
					});
				}
			}, {
				key: "cacheSec",
				value: function cacheSec() {
					var self = this;
					var endDate = void 0;
					var dateDiff = void 0;
					var secondDiff = void 0;
					// 每次读取 second 必须判断缓存，从缓存中取
					if (self._settings.cache) {
						endDate = self._storage.getState().endDate;
						if (!endDate) {
							return false;
						}
						if ((0, _moment2["default"])().isAfter((0, _moment2["default"])(endDate))) {
							return false;
						}
						dateDiff = (0, _moment2["default"])(endDate).diff((0, _moment2["default"])());
						secondDiff = dateDiff / 1000;
						secondDiff = Math.round(secondDiff);
						return secondDiff;
					} else {
						return false;
					}
				}
			}, {
				key: "watch",
				value: function watch(fn) {
					this._watchQueue.push(fn);
				}
			}, {
				key: "start",
				value: function start(sec) {
					if (typeof sec !== 'number') {
						sec = parseInt(sec, 10);
					}
					if (isNaN(sec)) {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (typeof sec !== 'number') {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (this._settings.cache && !this.cacheSec()) {
						this._setEndDateInCache(sec);
					}
					this.free = false;
					this._countDownSec = sec;
					this._countDown();
				}
			}]);

			return Timer;
		}();

		module.exports = Timer;

		/***/
	},
	/* 5 */
	/***/function (module, exports) {

		module.exports = moment;

		/***/
	},
	/* 6 */
	/***/function (module, exports, __webpack_require__) {

		!function (e, t) {
			true ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == (typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) ? exports.simpleBrowserStorage = t() : e.simpleBrowserStorage = t();
		}(this, function () {
			return function (e) {
				function t(n) {
					if (r[n]) return r[n].exports;var o = r[n] = { exports: {}, id: n, loaded: !1 };return e[n].call(o.exports, o, o.exports, t), o.loaded = !0, o.exports;
				}var r = {};return t.m = e, t.c = r, t.p = "", t(0);
			}([function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = r(3),
				    i = n(o),
				    a = r(2),
				    u = n(a),
				    c = function () {
					try {
						var e = "test";return localStorage.setItem(e, e), localStorage.removeItem(e), !0;
					} catch (t) {
						return !1;
					}
				}();t["default"] = function (e) {
					return c ? new i["default"](e) : new u["default"](e);
				}, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    i = r(4),
				    a = function () {
					function e(t) {
						n(this, e);var r = t || {};this.name = r.name || "SimpleBrowserStorage", this._expiresTime = r.expiresTime || 10;var o = this.stateIsExpired() ? {} : this.getState();o.expires = (0, i.addMinutes)(new Date(), this._expiresTime), this.updateState(o);
					}return o(e, [{ key: "setState", value: function value(e) {
							if ("object" != (typeof e === 'undefined' ? 'undefined' : _typeof(e))) throw new i.UserExpection("You can add only objects to state!");var t = this.getState() || {},
							    r = (0, i.extend)(t, e);this.updateState(r);
						} }, { key: "updateState", value: function value(e) {
							return e && !e.expires && (e.expires = (0, i.addMinutes)(new Date(), this._expiresTime)), e;
						} }, { key: "stateIsExpired", value: function value() {
							var e = this.getState() || {};if (!e.expires) return !0;var t = (0, i.dateToMins)(e.expires),
							    r = (0, i.dateToMins)() > t;return r;
						} }, { key: "expiresTime", get: function get() {
							return this._expiresTime;
						} }]), e;
				}();t["default"] = a, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function f(e) {
					var t = new Date(),
					    r = 60 * e * 1e3;return t.setTime(t.getTime() + r), t.toUTCString();
				},
				    l = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "cacheStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e),
							    n = "expires=" + f(this.expiresTime),
							    o = [this.name, "=", escape(JSON.stringify(r)), ";", n].join("");document.cookie = o;
						} }, { key: "getState", value: function value() {
							var e = document.cookie.match(new RegExp(this.name + "=([^;]+)"));return e ? JSON.parse(unescape(e[1])) : e;
						} }]), t;
				}(s["default"]);t["default"] = l, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "localStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e);localStorage.setItem(this.name, JSON.stringify(r));
						} }, { key: "getState", value: function value() {
							return JSON.parse(localStorage.getItem(this.name));
						} }]), t;
				}(s["default"]);t["default"] = f, e.exports = t["default"];
			}, function (e, t) {
				"use strict";
				Object.defineProperty(t, "__esModule", { value: !0 });var r = function r(e) {
					return { message: e, name: "UserExpection" };
				},
				    n = function n(e) {
					var t = e ? new Date(e) : new Date();return t.getTime() / 60 / 1e3;
				},
				    o = function o(e, t) {
					return new Date(e.getTime() + 6e4 * t);
				},
				    i = function i(e, t) {
					var r = void 0,
					    n = {};for (r in e) {
						Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
					}for (r in t) {
						Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);
					}return n;
				};t["default"] = { UserExpection: r, dateToMins: n, addMinutes: o, extend: i }, e.exports = t["default"];
			}]);
		});

		/***/
	},
	/* 7 */
	/***/function (module, exports) {

		module.exports = React;

		/***/
	},
	/* 8 */
	/***/function (module, exports, __webpack_require__) {

		var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__; /*!
	                                                                  Copyright (c) 2016 Jed Watson.
	                                                                  Licensed under the MIT License (MIT), see
	                                                                  http://jedwatson.github.io/classnames
	                                                                  */
		/* global define */

		(function () {
			'use strict';

			var hasOwn = {}.hasOwnProperty;

			function classNames() {
				var classes = [];

				for (var i = 0; i < arguments.length; i++) {
					var arg = arguments[i];
					if (!arg) continue;

					var argType = typeof arg === 'undefined' ? 'undefined' : _typeof(arg);

					if (argType === 'string' || argType === 'number') {
						classes.push(arg);
					} else if (Array.isArray(arg)) {
						classes.push(classNames.apply(null, arg));
					} else if (argType === 'object') {
						for (var key in arg) {
							if (hasOwn.call(arg, key) && arg[key]) {
								classes.push(key);
							}
						}
					}
				}

				return classes.join(' ');
			}

			if (typeof module !== 'undefined' && module.exports) {
				module.exports = classNames;
			} else if (true) {
				// register as 'classnames', consistent with npm package name
				!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = function () {
					return classNames;
				}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
			} else {
				window.classNames = classNames;
			}
		})();

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> ReactDOM = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-dom'</span>)
<span class="hljs-keyword">var</span> TimerBtn = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-timer/lib/react'</span>)
<span class="hljs-keyword">var</span> reactSendAjax = <span class="hljs-literal">false</span>
<span class="hljs-keyword">var</span> props = {
    <span class="hljs-attr">sec</span>: <span class="hljs-number">5</span>,
    <span class="hljs-comment">// cache: refresh page auto start | 缓存： 刷新页面自动开始计时</span>
    cache: <span class="hljs-string">'somer983ghiu3h'</span>,
    <span class="hljs-attr">className</span>: <span class="hljs-string">'m-btn'</span>,
    <span class="hljs-attr">timingClass</span>: <span class="hljs-string">'m-btn--timing'</span>,
    <span class="hljs-attr">trigger</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">start</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'react trigger'</span>)
        <span class="hljs-keyword">if</span> (reactSendAjax) {
            <span class="hljs-keyword">return</span>
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'react start'</span>)
            reactSendAjax = <span class="hljs-literal">true</span>
            <span class="hljs-comment">// mock send ajax timeout</span>
            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                start()
                reactSendAjax = <span class="hljs-literal">false</span>
            }, <span class="hljs-number">1000</span>)
        }
    },
    <span class="hljs-attr">html</span>: <span class="hljs-string">'React Send'</span>,
    <span class="hljs-attr">watch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">date</span>) </span>{
        <span class="hljs-keyword">if</span> (date.sec) {
            <span class="hljs-keyword">return</span> date.sec + <span class="hljs-string">'s'</span>
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'Resend'</span>
        }
    }
}
ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TimerBtn</span> {<span class="hljs-attr">...props</span>} /&gt;</span>, document.getElementById('reactNode'))
</span></code></pre>
	</div>
</div>
<h2 id="fast-timer-btn">fast-timer/btn</h2>
<button type="button" id="btn" class="m-btn" >Send</button>

<div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var timerBtn = __webpack_require__(1);
		var btn = document.getElementById('btn');
		var btnSendAjax = false;
		timerBtn(btn, {
			sec: 5,
			// cache: refresh page auto start | 缓存： 刷新页面自动开始计时
			cache: 'some242358',
			timingClass: 'm-btn--timing',
			trigger: function trigger(start) {
				console.log('btn trigger');
				if (btnSendAjax) {
					return;
				} else {
					btnSendAjax = true;
				}
				// mock send ajax timeout
				setTimeout(function () {
					console.log('btn start');
					btnSendAjax = false;
					start();
				}, 1000);
			},
			watch: function watch(date) {
				if (date.sec) {
					return date.sec + 's';
				} else {
					return 'Resend';
				}
			}
		});

		/***/
	},
	/* 1 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		Object.defineProperty(exports, "__esModule", {
			value: true
		});

		var _index = __webpack_require__(2);

		var _index2 = _interopRequireDefault(_index);

		var _classUtil = __webpack_require__(5);

		var _classUtil2 = _interopRequireDefault(_classUtil);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		var btn = function btn(ele, settings) {
			if (typeof ele === 'undefined') {
				throw new Error("timerBtn(ele, settings), ele is undefined!");
			}
			settings = settings || {};
			settings.timingClass = settings.timingClass || '';
			var time = new _index2["default"]({
				cache: settings.cache
			});
			var watchHandle = function watchHandle(date) {
				var text = settings.watch(date);
				ele.innerHTML = text;
				if (!date.sec) {
					_classUtil2["default"].removeClass(ele, settings.timingClass);
				}
			};
			if (time.cacheSec()) {
				time.start(time.cacheSec());
				_classUtil2["default"].addClass(ele, settings.timingClass);
				watchHandle({
					sec: time.cacheSec()
				});
			}
			time.watch(watchHandle);
			var triggerRunStart = function triggerRunStart() {
				_classUtil2["default"].addClass(ele, settings.timingClass);
				time.start(settings.sec);
			};
			var handleClick = function handleClick() {
				if (time.free) {
					settings.trigger(triggerRunStart);
				}
			};
			if (ele.addEventListener) {
				ele.addEventListener('click', handleClick, false);
			} else {
				ele.attachEvent('onclick', handleClick);
			}
		};
		exports["default"] = btn;

		module.exports = btn;

		/***/
	},
	/* 2 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		var _createClass = function () {
			function defineProperties(target, props) {
				for (var i = 0; i < props.length; i++) {
					var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
				}
			}return function (Constructor, protoProps, staticProps) {
				if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
			};
		}();

		var _moment = __webpack_require__(3);

		var _moment2 = _interopRequireDefault(_moment);

		var _simpleBrowserStorage = __webpack_require__(4);

		var _simpleBrowserStorage2 = _interopRequireDefault(_simpleBrowserStorage);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		function _classCallCheck(instance, Constructor) {
			if (!(instance instanceof Constructor)) {
				throw new TypeError("Cannot call a class as a function");
			}
		}

		var Timer = function () {
			function Timer(settings) {
				_classCallCheck(this, Timer);

				settings = settings || {};
				this.free = true;
				this._watchQueue = [];
				this._settings = settings;
				this._storage = (0, _simpleBrowserStorage2["default"])({
					name: settings.cache,
					expiresTime: 43200
				});
			}

			_createClass(Timer, [{
				key: "_countDown",
				value: function _countDown() {
					var self = this;
					// @1 @2 必须按先后顺序执行，因为 watch 需要获取 free
					// @1 Start
					if (self._countDownSec === 0) {
						this.free = true;
					} else {
						setTimeout(self._countDown.bind(self), 1000);
					}
					// @1 End
					// @2 Start
					self._watchQueue.forEach(function (fn) {
						fn.call(self, {
							sec: self._countDownSec
						});
					});
					// 递减需要在 watch 后执行。例如 sec 为 10 秒，最初应该 watch 触发 10 ，而不是 9。
					self._countDownSec = self._countDownSec - 1;
					// @2 End
				}
			}, {
				key: "_setEndDateInCache",
				value: function _setEndDateInCache(sec) {
					var self = this;
					self._storage.setState({
						endDate: (0, _moment2["default"])().add(sec, 's')
					});
				}
			}, {
				key: "cacheSec",
				value: function cacheSec() {
					var self = this;
					var endDate = void 0;
					var dateDiff = void 0;
					var secondDiff = void 0;
					// 每次读取 second 必须判断缓存，从缓存中取
					if (self._settings.cache) {
						endDate = self._storage.getState().endDate;
						if (!endDate) {
							return false;
						}
						if ((0, _moment2["default"])().isAfter((0, _moment2["default"])(endDate))) {
							return false;
						}
						dateDiff = (0, _moment2["default"])(endDate).diff((0, _moment2["default"])());
						secondDiff = dateDiff / 1000;
						secondDiff = Math.round(secondDiff);
						return secondDiff;
					} else {
						return false;
					}
				}
			}, {
				key: "watch",
				value: function watch(fn) {
					this._watchQueue.push(fn);
				}
			}, {
				key: "start",
				value: function start(sec) {
					if (typeof sec !== 'number') {
						sec = parseInt(sec, 10);
					}
					if (isNaN(sec)) {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (typeof sec !== 'number') {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (this._settings.cache && !this.cacheSec()) {
						this._setEndDateInCache(sec);
					}
					this.free = false;
					this._countDownSec = sec;
					this._countDown();
				}
			}]);

			return Timer;
		}();

		module.exports = Timer;

		/***/
	},
	/* 3 */
	/***/function (module, exports) {

		module.exports = moment;

		/***/
	},
	/* 4 */
	/***/function (module, exports, __webpack_require__) {

		!function (e, t) {
			true ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == (typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) ? exports.simpleBrowserStorage = t() : e.simpleBrowserStorage = t();
		}(this, function () {
			return function (e) {
				function t(n) {
					if (r[n]) return r[n].exports;var o = r[n] = { exports: {}, id: n, loaded: !1 };return e[n].call(o.exports, o, o.exports, t), o.loaded = !0, o.exports;
				}var r = {};return t.m = e, t.c = r, t.p = "", t(0);
			}([function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = r(3),
				    i = n(o),
				    a = r(2),
				    u = n(a),
				    c = function () {
					try {
						var e = "test";return localStorage.setItem(e, e), localStorage.removeItem(e), !0;
					} catch (t) {
						return !1;
					}
				}();t["default"] = function (e) {
					return c ? new i["default"](e) : new u["default"](e);
				}, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    i = r(4),
				    a = function () {
					function e(t) {
						n(this, e);var r = t || {};this.name = r.name || "SimpleBrowserStorage", this._expiresTime = r.expiresTime || 10;var o = this.stateIsExpired() ? {} : this.getState();o.expires = (0, i.addMinutes)(new Date(), this._expiresTime), this.updateState(o);
					}return o(e, [{ key: "setState", value: function value(e) {
							if ("object" != (typeof e === 'undefined' ? 'undefined' : _typeof(e))) throw new i.UserExpection("You can add only objects to state!");var t = this.getState() || {},
							    r = (0, i.extend)(t, e);this.updateState(r);
						} }, { key: "updateState", value: function value(e) {
							return e && !e.expires && (e.expires = (0, i.addMinutes)(new Date(), this._expiresTime)), e;
						} }, { key: "stateIsExpired", value: function value() {
							var e = this.getState() || {};if (!e.expires) return !0;var t = (0, i.dateToMins)(e.expires),
							    r = (0, i.dateToMins)() > t;return r;
						} }, { key: "expiresTime", get: function get() {
							return this._expiresTime;
						} }]), e;
				}();t["default"] = a, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function f(e) {
					var t = new Date(),
					    r = 60 * e * 1e3;return t.setTime(t.getTime() + r), t.toUTCString();
				},
				    l = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "cacheStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e),
							    n = "expires=" + f(this.expiresTime),
							    o = [this.name, "=", escape(JSON.stringify(r)), ";", n].join("");document.cookie = o;
						} }, { key: "getState", value: function value() {
							var e = document.cookie.match(new RegExp(this.name + "=([^;]+)"));return e ? JSON.parse(unescape(e[1])) : e;
						} }]), t;
				}(s["default"]);t["default"] = l, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "localStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e);localStorage.setItem(this.name, JSON.stringify(r));
						} }, { key: "getState", value: function value() {
							return JSON.parse(localStorage.getItem(this.name));
						} }]), t;
				}(s["default"]);t["default"] = f, e.exports = t["default"];
			}, function (e, t) {
				"use strict";
				Object.defineProperty(t, "__esModule", { value: !0 });var r = function r(e) {
					return { message: e, name: "UserExpection" };
				},
				    n = function n(e) {
					var t = e ? new Date(e) : new Date();return t.getTime() / 60 / 1e3;
				},
				    o = function o(e, t) {
					return new Date(e.getTime() + 6e4 * t);
				},
				    i = function i(e, t) {
					var r = void 0,
					    n = {};for (r in e) {
						Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
					}for (r in t) {
						Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);
					}return n;
				};t["default"] = { UserExpection: r, dateToMins: n, addMinutes: o, extend: i }, e.exports = t["default"];
			}]);
		});

		/***/
	},
	/* 5 */
	/***/function (module, exports) {

		'use strict';

		// https://github.com/maximobelen/class-stuff
		// @1.0.1

		var regularExp1 = '(\\s|^)',
		    regularExp2 = '(\\s|$)';

		function ClassStuff() {
			'use strict';

			if (!(this instanceof ClassStuff)) {
				return new ClassStuff();
			}
		}

		ClassStuff.prototype.addClass = function (element, className) {
			if (element.classList) {
				element.classList.add(className);
			} else {
				if (!hasClass(element, className)) {
					element.className += " " + className;
				}
			}
		};

		ClassStuff.prototype.removeClass = function (element, className) {
			if (element.classList) {
				element.classList.remove(className);
			} else {
				if (hasClass(element, className)) {
					var regClass = new RegExp(regularExp1 + className + regularExp2);
					element.className = element.className.replace(regClass, ' ');
				}
			}
		};

		ClassStuff.prototype.hasClass = function (element, className) {
			if (element.classList) {
				return element.classList.contains(className);
			} else {
				return !!element.className.match(new RegExp(regularExp1 + className + regularExp2));
			}
		};

		module.exports = ClassStuff();

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> timerBtn = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-timer/lib/btn'</span>)
<span class="hljs-keyword">var</span> btn = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'btn'</span>)
<span class="hljs-keyword">var</span> btnSendAjax = <span class="hljs-literal">false</span>
timerBtn(btn, {
    <span class="hljs-attr">sec</span>: <span class="hljs-number">5</span>,
    <span class="hljs-comment">// cache: refresh page auto start | 缓存： 刷新页面自动开始计时</span>
    cache: <span class="hljs-string">'some242358'</span>,
    <span class="hljs-attr">timingClass</span>: <span class="hljs-string">'m-btn--timing'</span>,
    <span class="hljs-attr">trigger</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">start</span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'btn trigger'</span>)
        <span class="hljs-keyword">if</span> (btnSendAjax) {
            <span class="hljs-keyword">return</span>
        }
        <span class="hljs-keyword">else</span> {
            btnSendAjax = <span class="hljs-literal">true</span>
        }
        <span class="hljs-comment">// mock send ajax timeout</span>
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'btn start'</span>)
            btnSendAjax = <span class="hljs-literal">false</span>
            start()
        }, <span class="hljs-number">1000</span>)
    },
    <span class="hljs-attr">watch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">date</span>) </span>{
        <span class="hljs-keyword">if</span> (date.sec) {
            <span class="hljs-keyword">return</span> date.sec + <span class="hljs-string">'s'</span>
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'Resend'</span>
        }
    }
})
</code></pre>
	</div>
</div>
<button type="button" id="demo" >click</button>

<h2 id="diy-api-">DIY | 使用API定制开发</h2>
<h3 id="simple">simple</h3>
<div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var Timer = __webpack_require__(1);

		var time = new Timer();
		var demo = document.getElementById('demo');
		// 定时回调
		time.watch(function (date) {
			console.log('second:' + date.sec);
			console.log('free:' + time.free);
			if (date.sec === 0) {
				demo.innerHTML = 'done';
			} else {
				demo.innerHTML = date.sec;
			}
		});
		demo.onclick = function () {
			if (time.free) {
				time.start(10);
			}
		};

		/***/
	},
	/* 1 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		Object.defineProperty(exports, "__esModule", {
			value: true
		});
		exports["default"] = __webpack_require__(2);

		module.exports = __webpack_require__(2);

		/***/
	},
	/* 2 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		var _createClass = function () {
			function defineProperties(target, props) {
				for (var i = 0; i < props.length; i++) {
					var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
				}
			}return function (Constructor, protoProps, staticProps) {
				if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
			};
		}();

		var _moment = __webpack_require__(3);

		var _moment2 = _interopRequireDefault(_moment);

		var _simpleBrowserStorage = __webpack_require__(4);

		var _simpleBrowserStorage2 = _interopRequireDefault(_simpleBrowserStorage);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		function _classCallCheck(instance, Constructor) {
			if (!(instance instanceof Constructor)) {
				throw new TypeError("Cannot call a class as a function");
			}
		}

		var Timer = function () {
			function Timer(settings) {
				_classCallCheck(this, Timer);

				settings = settings || {};
				this.free = true;
				this._watchQueue = [];
				this._settings = settings;
				this._storage = (0, _simpleBrowserStorage2["default"])({
					name: settings.cache,
					expiresTime: 43200
				});
			}

			_createClass(Timer, [{
				key: "_countDown",
				value: function _countDown() {
					var self = this;
					// @1 @2 必须按先后顺序执行，因为 watch 需要获取 free
					// @1 Start
					if (self._countDownSec === 0) {
						this.free = true;
					} else {
						setTimeout(self._countDown.bind(self), 1000);
					}
					// @1 End
					// @2 Start
					self._watchQueue.forEach(function (fn) {
						fn.call(self, {
							sec: self._countDownSec
						});
					});
					// 递减需要在 watch 后执行。例如 sec 为 10 秒，最初应该 watch 触发 10 ，而不是 9。
					self._countDownSec = self._countDownSec - 1;
					// @2 End
				}
			}, {
				key: "_setEndDateInCache",
				value: function _setEndDateInCache(sec) {
					var self = this;
					self._storage.setState({
						endDate: (0, _moment2["default"])().add(sec, 's')
					});
				}
			}, {
				key: "cacheSec",
				value: function cacheSec() {
					var self = this;
					var endDate = void 0;
					var dateDiff = void 0;
					var secondDiff = void 0;
					// 每次读取 second 必须判断缓存，从缓存中取
					if (self._settings.cache) {
						endDate = self._storage.getState().endDate;
						if (!endDate) {
							return false;
						}
						if ((0, _moment2["default"])().isAfter((0, _moment2["default"])(endDate))) {
							return false;
						}
						dateDiff = (0, _moment2["default"])(endDate).diff((0, _moment2["default"])());
						secondDiff = dateDiff / 1000;
						secondDiff = Math.round(secondDiff);
						return secondDiff;
					} else {
						return false;
					}
				}
			}, {
				key: "watch",
				value: function watch(fn) {
					this._watchQueue.push(fn);
				}
			}, {
				key: "start",
				value: function start(sec) {
					if (typeof sec !== 'number') {
						sec = parseInt(sec, 10);
					}
					if (isNaN(sec)) {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (typeof sec !== 'number') {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (this._settings.cache && !this.cacheSec()) {
						this._setEndDateInCache(sec);
					}
					this.free = false;
					this._countDownSec = sec;
					this._countDown();
				}
			}]);

			return Timer;
		}();

		module.exports = Timer;

		/***/
	},
	/* 3 */
	/***/function (module, exports) {

		module.exports = moment;

		/***/
	},
	/* 4 */
	/***/function (module, exports, __webpack_require__) {

		!function (e, t) {
			true ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == (typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) ? exports.simpleBrowserStorage = t() : e.simpleBrowserStorage = t();
		}(this, function () {
			return function (e) {
				function t(n) {
					if (r[n]) return r[n].exports;var o = r[n] = { exports: {}, id: n, loaded: !1 };return e[n].call(o.exports, o, o.exports, t), o.loaded = !0, o.exports;
				}var r = {};return t.m = e, t.c = r, t.p = "", t(0);
			}([function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = r(3),
				    i = n(o),
				    a = r(2),
				    u = n(a),
				    c = function () {
					try {
						var e = "test";return localStorage.setItem(e, e), localStorage.removeItem(e), !0;
					} catch (t) {
						return !1;
					}
				}();t["default"] = function (e) {
					return c ? new i["default"](e) : new u["default"](e);
				}, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    i = r(4),
				    a = function () {
					function e(t) {
						n(this, e);var r = t || {};this.name = r.name || "SimpleBrowserStorage", this._expiresTime = r.expiresTime || 10;var o = this.stateIsExpired() ? {} : this.getState();o.expires = (0, i.addMinutes)(new Date(), this._expiresTime), this.updateState(o);
					}return o(e, [{ key: "setState", value: function value(e) {
							if ("object" != (typeof e === 'undefined' ? 'undefined' : _typeof(e))) throw new i.UserExpection("You can add only objects to state!");var t = this.getState() || {},
							    r = (0, i.extend)(t, e);this.updateState(r);
						} }, { key: "updateState", value: function value(e) {
							return e && !e.expires && (e.expires = (0, i.addMinutes)(new Date(), this._expiresTime)), e;
						} }, { key: "stateIsExpired", value: function value() {
							var e = this.getState() || {};if (!e.expires) return !0;var t = (0, i.dateToMins)(e.expires),
							    r = (0, i.dateToMins)() > t;return r;
						} }, { key: "expiresTime", get: function get() {
							return this._expiresTime;
						} }]), e;
				}();t["default"] = a, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function f(e) {
					var t = new Date(),
					    r = 60 * e * 1e3;return t.setTime(t.getTime() + r), t.toUTCString();
				},
				    l = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "cacheStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e),
							    n = "expires=" + f(this.expiresTime),
							    o = [this.name, "=", escape(JSON.stringify(r)), ";", n].join("");document.cookie = o;
						} }, { key: "getState", value: function value() {
							var e = document.cookie.match(new RegExp(this.name + "=([^;]+)"));return e ? JSON.parse(unescape(e[1])) : e;
						} }]), t;
				}(s["default"]);t["default"] = l, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "localStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e);localStorage.setItem(this.name, JSON.stringify(r));
						} }, { key: "getState", value: function value() {
							return JSON.parse(localStorage.getItem(this.name));
						} }]), t;
				}(s["default"]);t["default"] = f, e.exports = t["default"];
			}, function (e, t) {
				"use strict";
				Object.defineProperty(t, "__esModule", { value: !0 });var r = function r(e) {
					return { message: e, name: "UserExpection" };
				},
				    n = function n(e) {
					var t = e ? new Date(e) : new Date();return t.getTime() / 60 / 1e3;
				},
				    o = function o(e, t) {
					return new Date(e.getTime() + 6e4 * t);
				},
				    i = function i(e, t) {
					var r = void 0,
					    n = {};for (r in e) {
						Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
					}for (r in t) {
						Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);
					}return n;
				};t["default"] = { UserExpection: r, dateToMins: n, addMinutes: o, extend: i }, e.exports = t["default"];
			}]);
		});

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> Timer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-timer'</span>)

<span class="hljs-keyword">var</span> time = <span class="hljs-keyword">new</span> Timer()
<span class="hljs-keyword">var</span> demo = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'demo'</span>)
<span class="hljs-comment">// 定时回调</span>
time.watch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">date</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'second:'</span> + date.sec)
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'free:'</span> + time.free)
    <span class="hljs-keyword">if</span> (date.sec === <span class="hljs-number">0</span>) {
        demo.innerHTML = <span class="hljs-string">'done'</span>
    }
    <span class="hljs-keyword">else</span> {
        demo.innerHTML = date.sec
    }
})
demo.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span> (time.free) {
        time.start(<span class="hljs-number">10</span>)
    }
}
</code></pre>
	</div>
</div>
<h3 id="cache">cache</h3>
<button type="button" id="cacheBtn" >cache</button>

<div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var Timer = __webpack_require__(1);
		var time = new Timer({
			cache: 'abc'
		});
		var cacheBtn = document.getElementById('cacheBtn');
		if (time.cacheSec()) {
			time.start(time.cacheSec());
			cacheBtn.innerHTML = time.cacheSec();
		}
		time.watch(function (date) {
			console.log('second:' + date.sec);
			console.log('free:' + time.free);
			if (date.sec === 0) {
				cacheBtn.innerHTML = 'done';
			} else {
				cacheBtn.innerHTML = date.sec;
			}
		});
		cacheBtn.onclick = function () {
			if (time.free) {
				time.start(10);
			}
		};

		/***/
	},
	/* 1 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		Object.defineProperty(exports, "__esModule", {
			value: true
		});
		exports["default"] = __webpack_require__(2);

		module.exports = __webpack_require__(2);

		/***/
	},
	/* 2 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		var _createClass = function () {
			function defineProperties(target, props) {
				for (var i = 0; i < props.length; i++) {
					var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
				}
			}return function (Constructor, protoProps, staticProps) {
				if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
			};
		}();

		var _moment = __webpack_require__(3);

		var _moment2 = _interopRequireDefault(_moment);

		var _simpleBrowserStorage = __webpack_require__(4);

		var _simpleBrowserStorage2 = _interopRequireDefault(_simpleBrowserStorage);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		function _classCallCheck(instance, Constructor) {
			if (!(instance instanceof Constructor)) {
				throw new TypeError("Cannot call a class as a function");
			}
		}

		var Timer = function () {
			function Timer(settings) {
				_classCallCheck(this, Timer);

				settings = settings || {};
				this.free = true;
				this._watchQueue = [];
				this._settings = settings;
				this._storage = (0, _simpleBrowserStorage2["default"])({
					name: settings.cache,
					expiresTime: 43200
				});
			}

			_createClass(Timer, [{
				key: "_countDown",
				value: function _countDown() {
					var self = this;
					// @1 @2 必须按先后顺序执行，因为 watch 需要获取 free
					// @1 Start
					if (self._countDownSec === 0) {
						this.free = true;
					} else {
						setTimeout(self._countDown.bind(self), 1000);
					}
					// @1 End
					// @2 Start
					self._watchQueue.forEach(function (fn) {
						fn.call(self, {
							sec: self._countDownSec
						});
					});
					// 递减需要在 watch 后执行。例如 sec 为 10 秒，最初应该 watch 触发 10 ，而不是 9。
					self._countDownSec = self._countDownSec - 1;
					// @2 End
				}
			}, {
				key: "_setEndDateInCache",
				value: function _setEndDateInCache(sec) {
					var self = this;
					self._storage.setState({
						endDate: (0, _moment2["default"])().add(sec, 's')
					});
				}
			}, {
				key: "cacheSec",
				value: function cacheSec() {
					var self = this;
					var endDate = void 0;
					var dateDiff = void 0;
					var secondDiff = void 0;
					// 每次读取 second 必须判断缓存，从缓存中取
					if (self._settings.cache) {
						endDate = self._storage.getState().endDate;
						if (!endDate) {
							return false;
						}
						if ((0, _moment2["default"])().isAfter((0, _moment2["default"])(endDate))) {
							return false;
						}
						dateDiff = (0, _moment2["default"])(endDate).diff((0, _moment2["default"])());
						secondDiff = dateDiff / 1000;
						secondDiff = Math.round(secondDiff);
						return secondDiff;
					} else {
						return false;
					}
				}
			}, {
				key: "watch",
				value: function watch(fn) {
					this._watchQueue.push(fn);
				}
			}, {
				key: "start",
				value: function start(sec) {
					if (typeof sec !== 'number') {
						sec = parseInt(sec, 10);
					}
					if (isNaN(sec)) {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (typeof sec !== 'number') {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (this._settings.cache && !this.cacheSec()) {
						this._setEndDateInCache(sec);
					}
					this.free = false;
					this._countDownSec = sec;
					this._countDown();
				}
			}]);

			return Timer;
		}();

		module.exports = Timer;

		/***/
	},
	/* 3 */
	/***/function (module, exports) {

		module.exports = moment;

		/***/
	},
	/* 4 */
	/***/function (module, exports, __webpack_require__) {

		!function (e, t) {
			true ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == (typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) ? exports.simpleBrowserStorage = t() : e.simpleBrowserStorage = t();
		}(this, function () {
			return function (e) {
				function t(n) {
					if (r[n]) return r[n].exports;var o = r[n] = { exports: {}, id: n, loaded: !1 };return e[n].call(o.exports, o, o.exports, t), o.loaded = !0, o.exports;
				}var r = {};return t.m = e, t.c = r, t.p = "", t(0);
			}([function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = r(3),
				    i = n(o),
				    a = r(2),
				    u = n(a),
				    c = function () {
					try {
						var e = "test";return localStorage.setItem(e, e), localStorage.removeItem(e), !0;
					} catch (t) {
						return !1;
					}
				}();t["default"] = function (e) {
					return c ? new i["default"](e) : new u["default"](e);
				}, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    i = r(4),
				    a = function () {
					function e(t) {
						n(this, e);var r = t || {};this.name = r.name || "SimpleBrowserStorage", this._expiresTime = r.expiresTime || 10;var o = this.stateIsExpired() ? {} : this.getState();o.expires = (0, i.addMinutes)(new Date(), this._expiresTime), this.updateState(o);
					}return o(e, [{ key: "setState", value: function value(e) {
							if ("object" != (typeof e === 'undefined' ? 'undefined' : _typeof(e))) throw new i.UserExpection("You can add only objects to state!");var t = this.getState() || {},
							    r = (0, i.extend)(t, e);this.updateState(r);
						} }, { key: "updateState", value: function value(e) {
							return e && !e.expires && (e.expires = (0, i.addMinutes)(new Date(), this._expiresTime)), e;
						} }, { key: "stateIsExpired", value: function value() {
							var e = this.getState() || {};if (!e.expires) return !0;var t = (0, i.dateToMins)(e.expires),
							    r = (0, i.dateToMins)() > t;return r;
						} }, { key: "expiresTime", get: function get() {
							return this._expiresTime;
						} }]), e;
				}();t["default"] = a, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function f(e) {
					var t = new Date(),
					    r = 60 * e * 1e3;return t.setTime(t.getTime() + r), t.toUTCString();
				},
				    l = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "cacheStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e),
							    n = "expires=" + f(this.expiresTime),
							    o = [this.name, "=", escape(JSON.stringify(r)), ";", n].join("");document.cookie = o;
						} }, { key: "getState", value: function value() {
							var e = document.cookie.match(new RegExp(this.name + "=([^;]+)"));return e ? JSON.parse(unescape(e[1])) : e;
						} }]), t;
				}(s["default"]);t["default"] = l, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "localStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e);localStorage.setItem(this.name, JSON.stringify(r));
						} }, { key: "getState", value: function value() {
							return JSON.parse(localStorage.getItem(this.name));
						} }]), t;
				}(s["default"]);t["default"] = f, e.exports = t["default"];
			}, function (e, t) {
				"use strict";
				Object.defineProperty(t, "__esModule", { value: !0 });var r = function r(e) {
					return { message: e, name: "UserExpection" };
				},
				    n = function n(e) {
					var t = e ? new Date(e) : new Date();return t.getTime() / 60 / 1e3;
				},
				    o = function o(e, t) {
					return new Date(e.getTime() + 6e4 * t);
				},
				    i = function i(e, t) {
					var r = void 0,
					    n = {};for (r in e) {
						Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
					}for (r in t) {
						Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);
					}return n;
				};t["default"] = { UserExpection: r, dateToMins: n, addMinutes: o, extend: i }, e.exports = t["default"];
			}]);
		});

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> Timer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-timer'</span>)
<span class="hljs-keyword">var</span> time = <span class="hljs-keyword">new</span> Timer({
    <span class="hljs-attr">cache</span>: <span class="hljs-string">'abc'</span>
})
<span class="hljs-keyword">var</span> cacheBtn = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'cacheBtn'</span>)
<span class="hljs-keyword">if</span> (time.cacheSec()) {
    time.start(time.cacheSec())
    cacheBtn.innerHTML = time.cacheSec()
}
time.watch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">date</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'second:'</span> + date.sec)
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'free:'</span> + time.free)
    <span class="hljs-keyword">if</span> (date.sec === <span class="hljs-number">0</span>) {
        cacheBtn.innerHTML = <span class="hljs-string">'done'</span>
    }
    <span class="hljs-keyword">else</span> {
        cacheBtn.innerHTML = date.sec
    }
})
cacheBtn.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (time.free) {
        time.start(<span class="hljs-number">10</span>)
    }
}
</code></pre>
	</div>
</div>
<h3 id="react-simple">React - simple</h3>
<div id="react1"></div>

<div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var Timer = __webpack_require__(1);
		var React = __webpack_require__(5);
		var ReactDOM = __webpack_require__(6);
		var App = React.createClass({
			displayName: 'App',

			getInitialState: function getInitialState() {
				return {
					sec: 0
				};
			},
			componentWillMount: function componentWillMount() {
				var self = this;
				self.time = new Timer();
				self.time.watch(function (date) {
					self.setState({
						sec: date.sec
					});
				});
			},
			startTimer: function startTimer() {
				if (this.time.free) {
					this.time.start(this.props.sec);
				}
			},
			render: function render() {
				return React.createElement('button', { onClick: this.startTimer }, this.state.sec ? this.state.sec : 'click');
			}
		});
		ReactDOM.render(React.createElement(App, { sec: 10 }), document.getElementById('react1'));

		/***/
	},
	/* 1 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		Object.defineProperty(exports, "__esModule", {
			value: true
		});
		exports["default"] = __webpack_require__(2);

		module.exports = __webpack_require__(2);

		/***/
	},
	/* 2 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		var _createClass = function () {
			function defineProperties(target, props) {
				for (var i = 0; i < props.length; i++) {
					var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
				}
			}return function (Constructor, protoProps, staticProps) {
				if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
			};
		}();

		var _moment = __webpack_require__(3);

		var _moment2 = _interopRequireDefault(_moment);

		var _simpleBrowserStorage = __webpack_require__(4);

		var _simpleBrowserStorage2 = _interopRequireDefault(_simpleBrowserStorage);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		function _classCallCheck(instance, Constructor) {
			if (!(instance instanceof Constructor)) {
				throw new TypeError("Cannot call a class as a function");
			}
		}

		var Timer = function () {
			function Timer(settings) {
				_classCallCheck(this, Timer);

				settings = settings || {};
				this.free = true;
				this._watchQueue = [];
				this._settings = settings;
				this._storage = (0, _simpleBrowserStorage2["default"])({
					name: settings.cache,
					expiresTime: 43200
				});
			}

			_createClass(Timer, [{
				key: "_countDown",
				value: function _countDown() {
					var self = this;
					// @1 @2 必须按先后顺序执行，因为 watch 需要获取 free
					// @1 Start
					if (self._countDownSec === 0) {
						this.free = true;
					} else {
						setTimeout(self._countDown.bind(self), 1000);
					}
					// @1 End
					// @2 Start
					self._watchQueue.forEach(function (fn) {
						fn.call(self, {
							sec: self._countDownSec
						});
					});
					// 递减需要在 watch 后执行。例如 sec 为 10 秒，最初应该 watch 触发 10 ，而不是 9。
					self._countDownSec = self._countDownSec - 1;
					// @2 End
				}
			}, {
				key: "_setEndDateInCache",
				value: function _setEndDateInCache(sec) {
					var self = this;
					self._storage.setState({
						endDate: (0, _moment2["default"])().add(sec, 's')
					});
				}
			}, {
				key: "cacheSec",
				value: function cacheSec() {
					var self = this;
					var endDate = void 0;
					var dateDiff = void 0;
					var secondDiff = void 0;
					// 每次读取 second 必须判断缓存，从缓存中取
					if (self._settings.cache) {
						endDate = self._storage.getState().endDate;
						if (!endDate) {
							return false;
						}
						if ((0, _moment2["default"])().isAfter((0, _moment2["default"])(endDate))) {
							return false;
						}
						dateDiff = (0, _moment2["default"])(endDate).diff((0, _moment2["default"])());
						secondDiff = dateDiff / 1000;
						secondDiff = Math.round(secondDiff);
						return secondDiff;
					} else {
						return false;
					}
				}
			}, {
				key: "watch",
				value: function watch(fn) {
					this._watchQueue.push(fn);
				}
			}, {
				key: "start",
				value: function start(sec) {
					if (typeof sec !== 'number') {
						sec = parseInt(sec, 10);
					}
					if (isNaN(sec)) {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (typeof sec !== 'number') {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (this._settings.cache && !this.cacheSec()) {
						this._setEndDateInCache(sec);
					}
					this.free = false;
					this._countDownSec = sec;
					this._countDown();
				}
			}]);

			return Timer;
		}();

		module.exports = Timer;

		/***/
	},
	/* 3 */
	/***/function (module, exports) {

		module.exports = moment;

		/***/
	},
	/* 4 */
	/***/function (module, exports, __webpack_require__) {

		!function (e, t) {
			true ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == (typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) ? exports.simpleBrowserStorage = t() : e.simpleBrowserStorage = t();
		}(this, function () {
			return function (e) {
				function t(n) {
					if (r[n]) return r[n].exports;var o = r[n] = { exports: {}, id: n, loaded: !1 };return e[n].call(o.exports, o, o.exports, t), o.loaded = !0, o.exports;
				}var r = {};return t.m = e, t.c = r, t.p = "", t(0);
			}([function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = r(3),
				    i = n(o),
				    a = r(2),
				    u = n(a),
				    c = function () {
					try {
						var e = "test";return localStorage.setItem(e, e), localStorage.removeItem(e), !0;
					} catch (t) {
						return !1;
					}
				}();t["default"] = function (e) {
					return c ? new i["default"](e) : new u["default"](e);
				}, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    i = r(4),
				    a = function () {
					function e(t) {
						n(this, e);var r = t || {};this.name = r.name || "SimpleBrowserStorage", this._expiresTime = r.expiresTime || 10;var o = this.stateIsExpired() ? {} : this.getState();o.expires = (0, i.addMinutes)(new Date(), this._expiresTime), this.updateState(o);
					}return o(e, [{ key: "setState", value: function value(e) {
							if ("object" != (typeof e === 'undefined' ? 'undefined' : _typeof(e))) throw new i.UserExpection("You can add only objects to state!");var t = this.getState() || {},
							    r = (0, i.extend)(t, e);this.updateState(r);
						} }, { key: "updateState", value: function value(e) {
							return e && !e.expires && (e.expires = (0, i.addMinutes)(new Date(), this._expiresTime)), e;
						} }, { key: "stateIsExpired", value: function value() {
							var e = this.getState() || {};if (!e.expires) return !0;var t = (0, i.dateToMins)(e.expires),
							    r = (0, i.dateToMins)() > t;return r;
						} }, { key: "expiresTime", get: function get() {
							return this._expiresTime;
						} }]), e;
				}();t["default"] = a, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function f(e) {
					var t = new Date(),
					    r = 60 * e * 1e3;return t.setTime(t.getTime() + r), t.toUTCString();
				},
				    l = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "cacheStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e),
							    n = "expires=" + f(this.expiresTime),
							    o = [this.name, "=", escape(JSON.stringify(r)), ";", n].join("");document.cookie = o;
						} }, { key: "getState", value: function value() {
							var e = document.cookie.match(new RegExp(this.name + "=([^;]+)"));return e ? JSON.parse(unescape(e[1])) : e;
						} }]), t;
				}(s["default"]);t["default"] = l, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "localStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e);localStorage.setItem(this.name, JSON.stringify(r));
						} }, { key: "getState", value: function value() {
							return JSON.parse(localStorage.getItem(this.name));
						} }]), t;
				}(s["default"]);t["default"] = f, e.exports = t["default"];
			}, function (e, t) {
				"use strict";
				Object.defineProperty(t, "__esModule", { value: !0 });var r = function r(e) {
					return { message: e, name: "UserExpection" };
				},
				    n = function n(e) {
					var t = e ? new Date(e) : new Date();return t.getTime() / 60 / 1e3;
				},
				    o = function o(e, t) {
					return new Date(e.getTime() + 6e4 * t);
				},
				    i = function i(e, t) {
					var r = void 0,
					    n = {};for (r in e) {
						Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
					}for (r in t) {
						Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);
					}return n;
				};t["default"] = { UserExpection: r, dateToMins: n, addMinutes: o, extend: i }, e.exports = t["default"];
			}]);
		});

		/***/
	},
	/* 5 */
	/***/function (module, exports) {

		module.exports = React;

		/***/
	},
	/* 6 */
	/***/function (module, exports) {

		module.exports = ReactDOM;

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> Timer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-timer'</span>)
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> ReactDOM = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-dom'</span>)
<span class="hljs-keyword">var</span> App = React.createClass({
    <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">sec</span>: <span class="hljs-number">0</span>
        }
    },
    <span class="hljs-attr">componentWillMount</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>
        self.time = <span class="hljs-keyword">new</span> Timer()
        self.time.watch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">date</span>) </span>{
            self.setState({
                <span class="hljs-attr">sec</span>: date.sec
            })
        })
    },
    <span class="hljs-attr">startTimer</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.time.free) {
            <span class="hljs-keyword">this</span>.time.start(<span class="hljs-keyword">this</span>.props.sec)
        }
    },
    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.startTimer}</span>&gt;</span>
            {this.state.sec?this.state.sec:'click'}
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
        )
    }
})
ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> <span class="hljs-attr">sec</span>=<span class="hljs-string">{10}</span> /&gt;</span>, document.getElementById('react1'))
</span></code></pre>
	</div>
</div>
<h3 id="react-cache">React - cache</h3>
<div id="reactCache"></div>

<div class="markrun markrun--js" >
	<div class="markrun-code" >
		<script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

	/******/(function (modules) {
		// webpackBootstrap
		/******/ // The module cache
		/******/var installedModules = {};

		/******/ // The require function
		/******/function __webpack_require__(moduleId) {

			/******/ // Check if module is in cache
			/******/if (installedModules[moduleId])
				/******/return installedModules[moduleId].exports;

			/******/ // Create a new module (and put it into the cache)
			/******/var module = installedModules[moduleId] = {
				/******/exports: {},
				/******/id: moduleId,
				/******/loaded: false
				/******/ };

			/******/ // Execute the module function
			/******/modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

			/******/ // Flag the module as loaded
			/******/module.loaded = true;

			/******/ // Return the exports of the module
			/******/return module.exports;
			/******/
		}

		/******/ // expose the modules object (__webpack_modules__)
		/******/__webpack_require__.m = modules;

		/******/ // expose the module cache
		/******/__webpack_require__.c = installedModules;

		/******/ // __webpack_public_path__
		/******/__webpack_require__.p = "";

		/******/ // Load entry module and return exports
		/******/return __webpack_require__(0);
		/******/
	})(
	/************************************************************************/
	/******/[
	/* 0 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		var Timer = __webpack_require__(1);
		var React = __webpack_require__(5);
		var ReactDOM = __webpack_require__(6);
		var App = React.createClass({
			displayName: 'App',

			getInitialState: function getInitialState() {
				return {
					sec: 0
				};
			},
			componentWillMount: function componentWillMount() {
				var self = this;
				self.time = new Timer({
					cache: 'abc'
				});
				self.time.watch(function (date) {
					self.setState({
						sec: date.sec
					});
				});
				if (self.time.cacheSec()) {
					self.time.start(self.time.cacheSec());
				}
			},
			startTimer: function startTimer() {
				if (this.time.free) {
					this.time.start(this.props.sec);
				}
			},
			render: function render() {
				return React.createElement('button', { onClick: this.startTimer }, this.state.sec ? this.state.sec : 'click');
			}
		});
		ReactDOM.render(React.createElement(App, { sec: 10 }), document.getElementById('reactCache'));

		/***/
	},
	/* 1 */
	/***/function (module, exports, __webpack_require__) {

		'use strict';

		Object.defineProperty(exports, "__esModule", {
			value: true
		});
		exports["default"] = __webpack_require__(2);

		module.exports = __webpack_require__(2);

		/***/
	},
	/* 2 */
	/***/function (module, exports, __webpack_require__) {

		"use strict";

		var _createClass = function () {
			function defineProperties(target, props) {
				for (var i = 0; i < props.length; i++) {
					var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
				}
			}return function (Constructor, protoProps, staticProps) {
				if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
			};
		}();

		var _moment = __webpack_require__(3);

		var _moment2 = _interopRequireDefault(_moment);

		var _simpleBrowserStorage = __webpack_require__(4);

		var _simpleBrowserStorage2 = _interopRequireDefault(_simpleBrowserStorage);

		function _interopRequireDefault(obj) {
			return obj && obj.__esModule ? obj : { "default": obj };
		}

		function _classCallCheck(instance, Constructor) {
			if (!(instance instanceof Constructor)) {
				throw new TypeError("Cannot call a class as a function");
			}
		}

		var Timer = function () {
			function Timer(settings) {
				_classCallCheck(this, Timer);

				settings = settings || {};
				this.free = true;
				this._watchQueue = [];
				this._settings = settings;
				this._storage = (0, _simpleBrowserStorage2["default"])({
					name: settings.cache,
					expiresTime: 43200
				});
			}

			_createClass(Timer, [{
				key: "_countDown",
				value: function _countDown() {
					var self = this;
					// @1 @2 必须按先后顺序执行，因为 watch 需要获取 free
					// @1 Start
					if (self._countDownSec === 0) {
						this.free = true;
					} else {
						setTimeout(self._countDown.bind(self), 1000);
					}
					// @1 End
					// @2 Start
					self._watchQueue.forEach(function (fn) {
						fn.call(self, {
							sec: self._countDownSec
						});
					});
					// 递减需要在 watch 后执行。例如 sec 为 10 秒，最初应该 watch 触发 10 ，而不是 9。
					self._countDownSec = self._countDownSec - 1;
					// @2 End
				}
			}, {
				key: "_setEndDateInCache",
				value: function _setEndDateInCache(sec) {
					var self = this;
					self._storage.setState({
						endDate: (0, _moment2["default"])().add(sec, 's')
					});
				}
			}, {
				key: "cacheSec",
				value: function cacheSec() {
					var self = this;
					var endDate = void 0;
					var dateDiff = void 0;
					var secondDiff = void 0;
					// 每次读取 second 必须判断缓存，从缓存中取
					if (self._settings.cache) {
						endDate = self._storage.getState().endDate;
						if (!endDate) {
							return false;
						}
						if ((0, _moment2["default"])().isAfter((0, _moment2["default"])(endDate))) {
							return false;
						}
						dateDiff = (0, _moment2["default"])(endDate).diff((0, _moment2["default"])());
						secondDiff = dateDiff / 1000;
						secondDiff = Math.round(secondDiff);
						return secondDiff;
					} else {
						return false;
					}
				}
			}, {
				key: "watch",
				value: function watch(fn) {
					this._watchQueue.push(fn);
				}
			}, {
				key: "start",
				value: function start(sec) {
					if (typeof sec !== 'number') {
						sec = parseInt(sec, 10);
					}
					if (isNaN(sec)) {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (typeof sec !== 'number') {
						throw new Error('time.start(sec), sec need to be a number!');
					}
					if (this._settings.cache && !this.cacheSec()) {
						this._setEndDateInCache(sec);
					}
					this.free = false;
					this._countDownSec = sec;
					this._countDown();
				}
			}]);

			return Timer;
		}();

		module.exports = Timer;

		/***/
	},
	/* 3 */
	/***/function (module, exports) {

		module.exports = moment;

		/***/
	},
	/* 4 */
	/***/function (module, exports, __webpack_require__) {

		!function (e, t) {
			true ? module.exports = t() : "function" == typeof define && define.amd ? define([], t) : "object" == (typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) ? exports.simpleBrowserStorage = t() : e.simpleBrowserStorage = t();
		}(this, function () {
			return function (e) {
				function t(n) {
					if (r[n]) return r[n].exports;var o = r[n] = { exports: {}, id: n, loaded: !1 };return e[n].call(o.exports, o, o.exports, t), o.loaded = !0, o.exports;
				}var r = {};return t.m = e, t.c = r, t.p = "", t(0);
			}([function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = r(3),
				    i = n(o),
				    a = r(2),
				    u = n(a),
				    c = function () {
					try {
						var e = "test";return localStorage.setItem(e, e), localStorage.removeItem(e), !0;
					} catch (t) {
						return !1;
					}
				}();t["default"] = function (e) {
					return c ? new i["default"](e) : new u["default"](e);
				}, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}Object.defineProperty(t, "__esModule", { value: !0 });var o = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    i = r(4),
				    a = function () {
					function e(t) {
						n(this, e);var r = t || {};this.name = r.name || "SimpleBrowserStorage", this._expiresTime = r.expiresTime || 10;var o = this.stateIsExpired() ? {} : this.getState();o.expires = (0, i.addMinutes)(new Date(), this._expiresTime), this.updateState(o);
					}return o(e, [{ key: "setState", value: function value(e) {
							if ("object" != (typeof e === 'undefined' ? 'undefined' : _typeof(e))) throw new i.UserExpection("You can add only objects to state!");var t = this.getState() || {},
							    r = (0, i.extend)(t, e);this.updateState(r);
						} }, { key: "updateState", value: function value(e) {
							return e && !e.expires && (e.expires = (0, i.addMinutes)(new Date(), this._expiresTime)), e;
						} }, { key: "stateIsExpired", value: function value() {
							var e = this.getState() || {};if (!e.expires) return !0;var t = (0, i.dateToMins)(e.expires),
							    r = (0, i.dateToMins)() > t;return r;
						} }, { key: "expiresTime", get: function get() {
							return this._expiresTime;
						} }]), e;
				}();t["default"] = a, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function f(e) {
					var t = new Date(),
					    r = 60 * e * 1e3;return t.setTime(t.getTime() + r), t.toUTCString();
				},
				    l = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "cacheStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e),
							    n = "expires=" + f(this.expiresTime),
							    o = [this.name, "=", escape(JSON.stringify(r)), ";", n].join("");document.cookie = o;
						} }, { key: "getState", value: function value() {
							var e = document.cookie.match(new RegExp(this.name + "=([^;]+)"));return e ? JSON.parse(unescape(e[1])) : e;
						} }]), t;
				}(s["default"]);t["default"] = l, e.exports = t["default"];
			}, function (e, t, r) {
				"use strict";
				function n(e) {
					return e && e.__esModule ? e : { "default": e };
				}function o(e, t) {
					if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
				}function i(e, t) {
					if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (typeof t === 'undefined' ? 'undefined' : _typeof(t)));e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t);
				}Object.defineProperty(t, "__esModule", { value: !0 });var a = function () {
					function e(e, t) {
						for (var r = 0; r < t.length; r++) {
							var n = t[r];n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
						}
					}return function (t, r, n) {
						return r && e(t.prototype, r), n && e(t, n), t;
					};
				}(),
				    u = function u(e, t, r) {
					for (var n = !0; n;) {
						var o = e,
						    i = t,
						    a = r;n = !1, null === o && (o = Function.prototype);var u = Object.getOwnPropertyDescriptor(o, i);if (void 0 !== u) {
							if ("value" in u) return u.value;var c = u.get;return void 0 === c ? void 0 : c.call(a);
						}var s = Object.getPrototypeOf(o);if (null === s) return void 0;e = s, t = i, r = a, n = !0, u = s = void 0;
					}
				},
				    c = r(1),
				    s = n(c),
				    f = function (e) {
					function t(e) {
						o(this, t), u(Object.getPrototypeOf(t.prototype), "constructor", this).call(this, e), this.storeType = "localStorage";
					}return i(t, e), a(t, [{ key: "updateState", value: function value(e) {
							var r = u(Object.getPrototypeOf(t.prototype), "updateState", this).call(this, e);localStorage.setItem(this.name, JSON.stringify(r));
						} }, { key: "getState", value: function value() {
							return JSON.parse(localStorage.getItem(this.name));
						} }]), t;
				}(s["default"]);t["default"] = f, e.exports = t["default"];
			}, function (e, t) {
				"use strict";
				Object.defineProperty(t, "__esModule", { value: !0 });var r = function r(e) {
					return { message: e, name: "UserExpection" };
				},
				    n = function n(e) {
					var t = e ? new Date(e) : new Date();return t.getTime() / 60 / 1e3;
				},
				    o = function o(e, t) {
					return new Date(e.getTime() + 6e4 * t);
				},
				    i = function i(e, t) {
					var r = void 0,
					    n = {};for (r in e) {
						Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]);
					}for (r in t) {
						Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);
					}return n;
				};t["default"] = { UserExpection: r, dateToMins: n, addMinutes: o, extend: i }, e.exports = t["default"];
			}]);
		});

		/***/
	},
	/* 5 */
	/***/function (module, exports) {

		module.exports = React;

		/***/
	},
	/* 6 */
	/***/function (module, exports) {

		module.exports = ReactDOM;

		/***/
	}
	/******/]);

/***/ }
/******/ ]);</script>
	</div>
	<div class="markrun-pre">
	<pre><code>
<span class="hljs-keyword">var</span> Timer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-timer'</span>)
<span class="hljs-keyword">var</span> React = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react'</span>)
<span class="hljs-keyword">var</span> ReactDOM = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-dom'</span>)
<span class="hljs-keyword">var</span> App = React.createClass({
    <span class="hljs-attr">getInitialState</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">sec</span>: <span class="hljs-number">0</span>
        }
    },
    <span class="hljs-attr">componentWillMount</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>
        self.time = <span class="hljs-keyword">new</span> Timer({
            <span class="hljs-attr">cache</span>: <span class="hljs-string">'abc'</span>
        })
        self.time.watch(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">date</span>) </span>{
            self.setState({
                <span class="hljs-attr">sec</span>: date.sec
            })
        })
        <span class="hljs-keyword">if</span> (self.time.cacheSec()) {
            self.time.start(self.time.cacheSec())
        }
    },
    <span class="hljs-attr">startTimer</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.time.free) {
            <span class="hljs-keyword">this</span>.time.start(<span class="hljs-keyword">this</span>.props.sec)
        }
    },
    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.startTimer}</span>&gt;</span>
            {this.state.sec?this.state.sec:'click'}
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
        )
    }
})
ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> <span class="hljs-attr">sec</span>=<span class="hljs-string">{10}</span> /&gt;</span>, document.getElementById('reactCache'))
</span></code></pre>
	</div>
</div>
<h2 id="development-">development | 参与开发</h2>
<pre><code class="lang-shell">git clone
cd timer
npm <span class="hljs-keyword">run</span><span class="bash"> update
</span>npm <span class="hljs-keyword">run</span><span class="bash"> dev
</span>npm <span class="hljs-keyword">run</span><span class="bash"> s</span>
</code></pre>
<link rel="stylesheet" href="http://cdn.bootcss.com/highlight.js/9.6.0/styles/atom-one-dark.min.css">

</body>
</html>
